vi ~/.terraformrc

provider_installation {
  network_mirror {
    url = "https://terraform-mirror.yandexcloud.net/"
    include = ["registry.terraform.io/*/*"]
  }
  direct {
    exclude = ["registry.terraform.io/*/*"]
  }
}

###########################################

terraform init
terraform fmt
terraform validate
terraform plan
terraform apply
terraform apply -auto-approve
terraform destroy
terraform destroy -auto-approve

###########################################

export TF_VAR_pm_api_token_secret="zzxxcc"

terraform apply -auto-approve -var="pm_api_token_secret=zzxxcc"

###########################################

–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ state
–ö–æ–º–∞–Ω–¥–∞ 	–û–ø–∏—Å–∞–Ω–∏–µ
terraform init 	–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ–µ–∫—Ç, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç backend –¥–ª—è state
terraform plan 	–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç–µ–∫—É—â–µ–≥–æ state
terraform apply 	–ü—Ä–∏–º–µ–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç state
terraform destroy 	–£–Ω–∏—á—Ç–æ–∂–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç state
terraform state list 	–í—ã–≤–æ–¥–∏—Ç –≤—Å–µ —Ä–µ—Å—É—Ä—Å—ã, –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –≤ state
terraform state show <addr> 	–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ —Ä–µ—Å—É—Ä—Å—É –∏–∑ state
terraform state rm <addr> 	–£–¥–∞–ª—è–µ—Ç —Ä–µ—Å—É—Ä—Å –∏–∑ state (–Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—è –≤–Ω–µ—à–Ω–∏–π –æ–±—ä–µ–∫—Ç)
terraform state mv <src> <dst> 	–ü–µ—Ä–µ–º–µ—â–∞–µ—Ç –∑–∞–ø–∏—Å—å –≤ state

    –ü—Ä–∏–º–µ—Ä <src> –∏ <dst>: –ø—É—Å—Ç—å —Ä–∞–Ω–µ–µ —Ä–µ—Å—É—Ä—Å –∏–º–µ–ª –∞–¥—Ä–µ—Å

    proxmox_virtual_environment_download_file.iso

    –∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –µ–≥–æ –≤

    proxmox_virtual_environment_download_file.ubuntu_image

    –¢–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

    terraform state mv proxmox_virtual_environment_download_file.iso proxmox_virtual_environment_download_file.ubuntu_image
    ```                                     |

    –ü—Ä–∏–º–µ—Ä <addr>: –µ—Å–ª–∏ terraform state list –≤—ã–≤–æ–¥–∏—Ç:

    proxmox_virtual_environment_vm.ubuntu_vm
    proxmox_virtual_environment_download_file.iso

    —Ç–æ —á—Ç–æ–±—ã –æ—Ç–≤—è–∑–∞—Ç—å ISO, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

    terraform state rm proxmox_virtual_environment_download_file.iso

###########################################

backend.tf –¥–ª—è S3:

terraform {
  backend "s3" {
    bucket  = "my-terraform-state-bucket"
    key     = "project/name/terraform.tfstate"
    region  = "us-east-1"
    encrypt = true
  }
}

backend.tf –¥–ª—è GitLab Remote:

terraform {
  backend "gitlab" {
    address = "https://gitlab.com"
    project = "my-group/my-terraform-state"
    token   = var.gitlab_token
    lock    = true
  }

Backend 	–û–ø–∏—Å–∞–Ω–∏–µ 	–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
local 	–õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª 	(–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
s3 	AWS S3 	backend "s3" { ... }
consul 	Consul KV 	backend "consul" { ... }
azurerm 	Azure Storage 	backend "azurerm" { ... }
gcs 	Google Cloud Storage 	backend "gcs" { ... }
gitlab 	GitLab Remote 	backend "gitlab" { ... }

###########################################

Terraform: count –∏ for_each (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
üëâ https://developer.hashicorp.com/terraform/language/meta-arguments/count

Terraform: –£—Å–ª–æ–≤–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
üëâ https://developer.hashicorp.com/terraform/language/expressions/conditionals

Terraform: locals
üëâ https://developer.hashicorp.com/terraform/language/values/locals

Terraform: –ú–æ–¥—É–ª–∏
üëâ https://developer.hashicorp.com/terraform/language/modules/syntax

###########################################

Terraform –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–µ—Å—è—Ç–∫–∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, —Å –ø–æ–º–æ—â—å—é –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–∂–Ω–æ:

    –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–ø–∏—Å–∫–∏ –∏ –∫–∞—Ä—Ç—ã (length, join, merge, flatten)

    –¥–µ–ª–∞—Ç—å —É—Å–ª–æ–≤–∏—è (contains, lookup, try)

    –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å —Ç–∏–ø—ã (toset, tolist, tostring)

    —á–∏—Ç–∞—Ç—å –≤–Ω–µ—à–Ω–∏–µ —Ñ–∞–π–ª—ã (file, templatefile)

    —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø—É—Ç—è–º–∏ (dirname, basename, path.module)

###########################################
